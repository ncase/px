<script>

var img = new Image();
img.crossOrigin = "Anonymous";
img.onload = function(){

    // DATA URL
    var canvas = document.createElement("canvas");
    canvas.width = img.width;
    canvas.height = img.height;
    var ctx = canvas.getContext('2d');
    ctx.drawImage(img,0,0);
    var image = canvas.toDataURL();

    document.body.appendChild(canvas);

    // POST
    var xhr = new XMLHttpRequest();
    xhr.open("POST","/art");
    xhr.setRequestHeader('Content-type','application/x-www-form-urlencoded');
    xhr.onreadystatechange = function() {
        if(xhr.readyState===4 && xhr.status===200){

        	var html = "";

            var arts = JSON.parse(xhr.responseText);
            for(var i=0;i<arts.length;i++){
            	var art = arts[i];
            	html += "<li><img src='"+art.url+"'/> by "+art.author+"</li>";
            }

            html = "<ol>"+html+"</ol>";
            document.body.innerHTML = html;

        }
    };

    xhr.send("author=drawer&image="+encodeURIComponent(image));

};

img.src = "http://commondatastorage.googleapis.com/ncase-px/PonyEmoticons.png";

</script>